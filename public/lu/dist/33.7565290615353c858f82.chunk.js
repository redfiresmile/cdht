webpackJsonp([33],{263:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(490),l=a.n(s);for(var o in s)"default"!==o&&function(e){a.d(t,e,function(){return s[e]})}(o);var n=a(879),r=a.n(n),i=a(3),d=i(l.a,r.a,!1,null,null,null);d.options.__file="src/views/privileges/users/list.vue",t.default=d.exports},490:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(26),l=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default={data:function(){var e=this;return{modalHeadImage:{show:!1,url:null},loading:!1,tableStatus:{enable:[],is_admin:[]},search:{},roleModal:{id:0,allRoles:[],hasRoles:[],show:!1,saveLoading:!1,listStyle:{width:"400px",height:"400px"}},feeds:{data:[],total:0,current_page:1,per_page:10},columns:[{title:"ID",key:"id",sortable:!0,width:100},{title:"昵称",key:"name"},{title:"头像",key:"",render:function(t,a){var s=e;return t("div",[t("img",{attrs:{src:a.row.head_image.url,"data-fancybox":"12312"},class:"head_image",style:{width:"40px",height:"40px"},on:{click:function(e){s.modalHeadImage.show=!0,s.modalHeadImage.url=a.row.head_image.url}}})])}},{title:"邮箱",key:"email"},{title:"后台权限",width:150,render:function(e,t){var a=t.row;return e("div",[e("Tag",{props:{type:"dot",color:"T"===a.is_admin?"green":"red"}},"T"===a.is_admin?"可登录":"不可登录")])}},{title:"启用状态",key:"enable",render:function(t,a){return t("i-switch",{props:{slot:"open",type:"primary",value:"T"===a.row.enable},on:{"on-change":function(t){e.switchEnable(a.index)}}})}},{title:"创建时间",key:"created_at"},{title:"操作",key:"",render:function(t,a){var s=e;return t("div",[t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){var t={user_id:a.row.id};e.$router.push({name:"edit-user",params:t})}}},"Edit"),t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){s.getUserRoles(a.row.id),s.roleModal.show=!0,s.roleModal.id=a.row.id}}},"角色"),t("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.name+"」？",transfer:!0},on:{"on-ok":function(){s.deleteBtn(a.row.id,a.index)}}},[t("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},created:function(){var e=this;e.getList(e.feeds.current_page),e.getAllRole(),e.getTableStatus()},methods:{handleOnPageChange:function(e){this.getList(e)},getTableStatus:function(){var e=this;e.$util.ajax.get("/common_get_table_status/users").then(function(t){var a=t.data;e.tableStatus.enable=a.data.enable,e.tableStatus.is_admin=a.data.is_admin},function(e){})},getList:function(e){var t=this;t.loading=!0,t.feeds.current_page=e,t.$util.ajax.get("/admin/users?page="+e+"&per_page="+t.feeds.per_page+"&search_data="+(0,l.default)(t.search)).then(function(e){var a=e.data;t.feeds.data=a.data,t.feeds.total=a.meta.total,t.loading=!1},function(e){t.$Notice.warning({title:"出错了",desc:e.message}),t.loading=!1})},switchEnable:function(e){var t=this,a="T";"T"===t.feeds.data[e].enable&&(a="F"),t.$util.ajax.post("/common_switch_enable",{table:"users",id:t.feeds.data[e].id,value:a}).then(function(s){t.feeds.data[e].enable=a;var l=s.data;t.$Notice.success({title:l.message})},function(e){t.$Notice.warning({title:"出错了",desc:e.message})})},getAllRole:function(){var e=this;e.$util.ajax.get("/admin/all_roles").then(function(t){var a=t.data;e.roleModal.allRoles=a.data},function(t){e.$Notice.warning({title:"出错了",desc:t.message})})},handleTransferChange:function(e){this.roleModal.hasRoles=e},getUserRoles:function(e){var t=this;t.$util.ajax.get("/admin/users/"+e+"/roles").then(function(e){var a=e.data;t.roleModal.hasRoles=a.data},function(e){t.$Notice.warning({title:"出错了",desc:e.message})})},renderFormat:function(e){return e.label+"「"+e.description+"」"},handleSubmitRole:function(){var e=this;e.$util.ajax.post("/admin/give/"+e.roleModal.id+"/roles",{role:e.roleModal.hasRoles}).then(function(t){var a=t.data;e.$Notice.success({title:a.message}),e.roleModal.show=!1},function(t){e.$Notice.warning({title:"出错了",desc:t.message})})},cancelRoleModal:function(){var e=this;e.roleModal.show=!1,e.roleModal.saveLoading=!1},deleteBtn:function(e,t){var a=this;a.$util.ajax.delete("/admin/users/"+e).then(function(e){var s=e.data;a.feeds.data.splice(t,1),a.$Notice.success({title:s.message})},function(e){a.$Notice.warning({title:"出错了",desc:e.message})})}}}},879:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"privileges-users-list"}},[a("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end",gutter:16}},[a("Col",{attrs:{span:"2"}},[a("Select",{attrs:{placeholder:"请选择状态"},model:{value:e.search.enable,callback:function(t){e.$set(e.search,"enable",t)},expression:"search.enable"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._v(" "),e._l(e.tableStatus.enable,function(t,s){return a("Option",{key:s,attrs:{value:s}},[e._v(e._s(t))])})],2)],1),e._v(" "),a("Col",{attrs:{span:"2"}},[a("Select",{attrs:{placeholder:"管理员"},model:{value:e.search.is_admin,callback:function(t){e.$set(e.search,"is_admin",t)},expression:"search.is_admin"}},[a("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._v(" "),e._l(e.tableStatus.is_admin,function(t,s){return a("Option",{key:s,attrs:{value:s}},[e._v(e._s(t))])})],2)],1),e._v(" "),a("Col",{attrs:{span:"3"}},[a("Input",{attrs:{icon:"search",placeholder:"请输入邮箱搜索..."},model:{value:e.search.email,callback:function(t){e.$set(e.search,"email",t)},expression:"search.email"}})],1),e._v(" "),a("Col",{attrs:{span:"2"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){e.getList(e.feeds.current_page)}}},[e._v("Search")])],1)],1),e._v(" "),a("br"),e._v(" "),a("Row",[a("Table",{attrs:{border:"",columns:e.columns,data:e.feeds.data,loading:e.loading}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:e.feeds.total,current:e.feeds.current_page,"page-size":e.feeds.per_page,"show-elevator":"","show-total":""},on:{"on-change":e.handleOnPageChange}})],1)])],1),e._v(" "),a("Modal",{model:{value:e.modalHeadImage.show,callback:function(t){e.$set(e.modalHeadImage,"show",t)},expression:"modalHeadImage.show"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v("图片预览")]),e._v(" "),a("div",{staticClass:"text-center"},[e.modalHeadImage.show?a("img",{staticClass:"center-align",attrs:{src:e.modalHeadImage.url,alt:""}}):e._e()]),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"})]),e._v(" "),a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"1000"},model:{value:e.roleModal.show,callback:function(t){e.$set(e.roleModal,"show",t)},expression:"roleModal.show"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("分配权限")]),e._v(" "),e.roleModal.show?a("Transfer",{attrs:{data:e.roleModal.allRoles,"target-keys":e.roleModal.hasRoles,"render-format":e.renderFormat,operations:["移除角色","添加角色"],"list-style":e.roleModal.listStyle,filterable:""},on:{"on-change":e.handleTransferChange}}):e._e(),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelRoleModal}},[e._v("取消")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.handleSubmitRole}},[e._v("保存\n            ")])],1)],1)],1)},l=[];s._withStripped=!0;var o={render:s,staticRenderFns:l};t.default=o}});
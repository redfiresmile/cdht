(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["d5a6"],{d5a6:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{gutter:24}},[a("Col",{attrs:{xs:8,lg:16}},[a("Button",{attrs:{type:"success",icon:"plus"},on:{click:function(t){e.addBtn()}}},[e._v("Add")])],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:12,lg:4}},[a("Input",{attrs:{icon:"search",placeholder:"请输入角色名称..."},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:3,lg:3}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(t){e.getTableDataExcute()}}},[e._v("Search")])],1)],1),a("br"),a("Row",[e.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[e._v("加载中...")])],1)],1):e._e(),a("Table",{attrs:{border:"",columns:e.columns,data:e.dataList},on:{"on-sort-change":e.onSortChange}})],1),a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"800"},model:{value:e.permissionModal.show,callback:function(t){e.$set(e.permissionModal,"show",t)},expression:"permissionModal.show"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("分配权限")]),e.permissionModal.show?a("Transfer",{attrs:{data:e.permissionModal.allPermissions,"target-keys":e.permissionModal.hasPermissions,"render-format":e.renderFormat,operations:["移除权限","添加权限"],"list-style":e.permissionModal.listStyle,filterable:""},on:{"on-change":e.handleTransferChange}}):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelPermissionModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.giveRolePermissionExcute}},[e._v("保存 ")])],1)],1),e.addModal.show?a("add-component",{on:{"on-add-modal-success":e.getTableDataExcute,"on-add-modal-hide":e.addModalHide}}):e._e(),e.editModal.show?a("edit-component",{attrs:{"modal-id":e.editModal.id},on:{"on-edit-modal-success":e.getTableDataExcute,"on-edit-modal-hide":e.editModalHide}}):e._e()],1)},i=[],s=(a("7f7f"),a("cadf"),a("551c"),a("097d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"600"},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v("添加角色")]),a("Form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"角色名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输角色名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("FormItem",{attrs:{label:"看守器",prop:"guard_name"}},[a("Input",{attrs:{placeholder:"请输入看守器"},model:{value:e.formData.guard_name,callback:function(t){e.$set(e.formData,"guard_name",t)},expression:"formData.guard_name"}})],1),a("FormItem",{attrs:{label:"角色描述",prop:"description"}},[a("Input",{attrs:{placeholder:"请输入角色描述"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.addEditRoleExcute}},[e._v("保存 ")])],1)],1)],1)}),n=[],r=a("66df"),l=function(e){return r["a"].request({url:"/api/admin/roles",params:{search_data:JSON.stringify(e)},method:"get"})},d=function(){return r["a"].request({url:"/api/admin/all_permissions",method:"get"})},c=function(e){return r["a"].request({url:"/api/admin/roles",data:e,method:"post"})},m=function(e){return r["a"].request({url:"api/admin/roles/"+e+"/permissions",method:"get"})},u=function(e,t){return r["a"].request({url:"/api/admin/give/"+e+"/permissions",data:{permission:t},method:"post"})},p=function(e){return r["a"].request({url:"/api/admin/roles/"+e,method:"delete"})},h=function(e){return r["a"].request({url:"/api/admin/roles/"+e,method:"get"})},f={data:function(){return{modalShow:!0,saveLoading:!1,formData:{name:"",guard_name:"",description:""},rules:{name:[{required:!0,message:"请填写角色限名称",trigger:"blur"}],guard_name:[{required:!0,message:"请填写看守器",trigger:"blur"}]}}},methods:{addEditRoleExcute:function(){var e=this;e.$refs.formData.validate(function(t){t&&(e.saveLoading=!0,c(e.formData).then(function(t){e.saveLoading=!1,e.modalShow=!1,e.$emit("on-add-modal-success"),e.$emit("on-add-modal-hide"),e.$Notice.success({title:t.message})},function(t){e.saveLoading=!1}))})},cancel:function(){this.modalShow=!1,this.$emit("on-add-modal-hide")}}},g=f,v=a("66b7"),b=Object(v["a"])(g,s,n,!1,null,null,null);b.options.__file="add-role.vue";var _=b.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"600"},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[e._v("添加角色")]),a("Form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"角色名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输角色名称"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("FormItem",{attrs:{label:"看守器",prop:"guard_name"}},[a("Input",{attrs:{placeholder:"请输入看守器"},model:{value:e.formData.guard_name,callback:function(t){e.$set(e.formData,"guard_name",t)},expression:"formData.guard_name"}})],1),a("FormItem",{attrs:{label:"角色描述",prop:"description"}},[a("Input",{attrs:{placeholder:"请输入角色描述"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.addEditRoleExcute}},[e._v("保存 ")])],1),!0===e.spinLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[e._v("加载中...")])],1)],1):e._e()],1)],1)},x=[],y=(a("c5f6"),{props:{modalId:{type:Number,default:0}},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{name:"",guard_name:"",description:""},rules:{name:[{required:!0,message:"请填写角色限名称",trigger:"blur"}],guard_name:[{required:!0,message:"请填写看守器",trigger:"blur"}]}}},mounted:function(){this.modalId>0&&this.getRoleInfoByIdExcute()},methods:{getRoleInfoByIdExcute:function(){var e=this;h(e.modalId).then(function(t){var a=t.data;e.formData={id:a.id,name:a.name,guard_name:a.guard_name,description:a.description},e.spinLoading=!1})},addEditRoleExcute:function(){var e=this;e.$refs.formData.validate(function(t){t&&(e.saveLoading=!0,c(e.formData).then(function(t){e.saveLoading=!1,e.modalShow=!1,e.$emit("on-edit-modal-success"),e.$emit("on-edit-modal-hide"),e.$Notice.success({title:t.message})},function(t){e.saveLoading=!1}))})},cancel:function(){this.modalShow=!1,this.$emit("on-edit-modal-hide")}}}),D=y,M=Object(v["a"])(D,w,x,!1,null,null,null);M.options.__file="edit-role.vue";var k=M.exports,E={components:{AddComponent:_,EditComponent:k},data:function(){var e=this;return{searchForm:{order_by:"id,desc"},tableLoading:!1,dataList:[],modalHeadImage:{show:!1,url:null},permissionModal:{id:0,allPermissions:[],hasPermissions:[],show:!1,saveLoading:!1,listStyle:{width:"250px",height:"300px"}},addModal:{show:!1},editModal:{show:!1,id:0},columns:[{title:"ID",key:"id",sortable:"customer",minWidth:100},{title:"角色限名称",key:"name",minWidth:150},{title:"角色看守器",key:"guard_name",minWidth:150},{title:"角色描述",key:"description",minWidth:150},{title:"创建时间",key:"created_at",minWidth:150},{title:"更新时间",key:"created_at",minWidth:150},{title:"操作",minWidth:200,render:function(t,a){var o=e;return t("div",[t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.editModal.show=!0,e.editModal.id=a.row.id}}},"Edit"),t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){o.getRolePermissionsExcute(a.row.id),o.permissionModal.show=!0,o.permissionModal.id=a.row.id}}},"权限"),t("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.name+"」角色？",transfer:!0},on:{"on-ok":function(){o.deleteRoleExcute(a.row.id,a.index)}}},[t("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},created:function(){var e=this;e.getTableDataExcute(),e.getAllPermissionExcute()},methods:{renderFormat:function(e){return e.label+"「"+e.description+"」"},cancelPermissionModal:function(){var e=this;e.permissionModal.show=!1,e.permissionModal.saveLoading=!1},getAllPermissionExcute:function(){var e=this;d().then(function(t){e.permissionModal.allPermissions=t.data},function(e){})},getTableDataExcute:function(){var e=this;e.tableLoading=!0,l(e.searchForm).then(function(t){var a=t.data;e.dataList=a,e.tableLoading=!1},function(t){e.tableLoading=!1})},onSortChange:function(e){var t=e.column.key+","+e.order;this.searchForm.order_by=t,this.getTableDataExcute()},handleTransferChange:function(e){this.permissionModal.hasPermissions=e},getRolePermissionsExcute:function(e){var t=this;m(e).then(function(e){t.permissionModal.hasPermissions=e.data})},giveRolePermissionExcute:function(){var e=this;u(e.permissionModal.id,e.permissionModal.hasPermissions).then(function(t){e.$Notice.success({title:t.message}),e.permissionModal.show=!1})},deleteRoleExcute:function(e,t){var a=this;p(e).then(function(e){a.dataList.splice(t,1),a.$Notice.success({title:e.message})})},addBtn:function(){this.addModal.show=!0},addModalHide:function(){this.addModal.show=!1},editModalHide:function(){this.editModal.show=!1}}},I=E,L=Object(v["a"])(I,o,i,!1,null,null,null);L.options.__file="list.vue";t["default"]=L.exports}}]);
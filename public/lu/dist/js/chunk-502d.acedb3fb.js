(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-502d"],{"1e5d":function(e,a,t){},2934:function(e,a,t){"use strict";t.d(a,"b",function(){return i}),t.d(a,"c",function(){return n}),t.d(a,"a",function(){return s});var o=t("66df"),i=function(e){return o["a"].request({url:"/api/common_get_table_status/"+e,method:"get"})},n=function(e,a,t){return o["a"].request({url:"/api/common_switch_enable",data:{id:e,table:a,value:t},method:"post"})},s=function(e){return o["a"].request({url:"/api/admin/attachments/"+e+"/force_destroy",method:"delete"})}},"6a8f":function(e,a,t){"use strict";var o=t("1e5d"),i=t.n(o);i.a},"8f8b":function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("Row",{attrs:{gutter:24}},[t("Col",{attrs:{xs:7,lg:11}},[t("Button",{attrs:{type:"success",icon:"plus"},on:{click:function(a){e.addBtn()}}},[e._v("Add")])],1),t("Col",{attrs:{xs:3,lg:3}},[t("Select",{attrs:{placeholder:"请选择状态"},model:{value:e.searchForm.enable,callback:function(a){e.$set(e.searchForm,"enable",a)},expression:"searchForm.enable"}},[t("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._l(e.tableStatus.enable,function(a,o){return t("Option",{key:o,attrs:{value:o}},[e._v(e._s(a))])})],2)],1),t("Col",{attrs:{xs:3,lg:3}},[t("Select",{attrs:{placeholder:"管理员"},model:{value:e.searchForm.is_admin,callback:function(a){e.$set(e.searchForm,"is_admin",a)},expression:"searchForm.is_admin"}},[t("Option",{key:"",attrs:{value:""}},[e._v("全部")]),e._l(e.tableStatus.is_admin,function(a,o){return t("Option",{key:o,attrs:{value:o}},[e._v(e._s(a))])})],2)],1),t("Col",{staticClass:"hidden-mobile",attrs:{xs:6,lg:3}},[t("Input",{attrs:{icon:"search",placeholder:"请输入邮箱搜索..."},model:{value:e.searchForm.email,callback:function(a){e.$set(e.searchForm,"email",a)},expression:"searchForm.email"}})],1),t("Col",{attrs:{xs:3,lg:3}},[t("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(a){e.getTableDataExcute(e.feeds.current_page)}}},[e._v("Search")])],1)],1),t("br"),t("Row",[e.tableLoading?t("div",{staticClass:"demo-spin-container"},[t("Spin",{attrs:{fix:""}},[t("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),t("div",[e._v("加载中...")])],1)],1):e._e(),t("Table",{attrs:{border:"",columns:e.columns,data:e.feeds.data},on:{"on-sort-change":e.onSortChange}}),t("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[t("div",{staticStyle:{float:"right"}},[t("Page",{staticClass:"paging",attrs:{total:e.feeds.total,current:e.feeds.current_page,"page-size":e.feeds.per_page,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-change":e.handleOnPageChange,"on-page-size-change":e.onPageSizeChange}})],1)])],1),t("Modal",{model:{value:e.modalHeadImage.show,callback:function(a){e.$set(e.modalHeadImage,"show",a)},expression:"modalHeadImage.show"}},[t("p",{attrs:{slot:"header"},slot:"header"},[e._v("图片预览")]),t("div",{staticClass:"text-center"},[e.modalHeadImage.show?t("img",{staticClass:"center-align",staticStyle:{width:"100%"},attrs:{src:e.modalHeadImage.url,alt:""}}):e._e()]),t("div",{attrs:{slot:"footer"},slot:"footer"})]),t("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"800"},model:{value:e.roleModal.show,callback:function(a){e.$set(e.roleModal,"show",a)},expression:"roleModal.show"}},[t("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("分配权限")]),e.roleModal.show?t("Transfer",{attrs:{data:e.roleModal.allRoles,"target-keys":e.roleModal.hasRoles,"render-format":e.renderFormat,operations:["移除角色","添加角色"],"list-style":e.roleModal.listStyle,filterable:""},on:{"on-change":e.handleTransferChange}}):e._e(),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancelRoleModal}},[e._v("取消")]),t("Button",{attrs:{type:"primary"},on:{click:e.giveUserRoleExcute}},[e._v("保存 ")])],1)],1),e.addModal.show?t("add-component",{on:{"on-add-modal-success":function(a){e.getTableDataExcute(e.feeds.current_page)},"on-add-modal-hide":e.addModalHide}}):e._e(),e.editModal.show?t("edit-component",{attrs:{"modal-id":e.editModal.id},on:{"on-edit-modal-success":function(a){e.getTableDataExcute(e.feeds.current_page)},"on-edit-modal-hide":e.editModalHide}}):e._e()],1)},i=[],n=(t("7f7f"),t("cadf"),t("551c"),t("097d"),function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"600"},model:{value:e.modalShow,callback:function(a){e.modalShow=a},expression:"modalShow"}},[t("p",{attrs:{slot:"header"},slot:"header"},[e._v("添加用户")]),t("Form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":100}},[t("FormItem",{attrs:{label:"昵称：",prop:"name"}},[t("Input",{model:{value:e.formData.name,callback:function(a){e.$set(e.formData,"name",a)},expression:"formData.name"}})],1),t("FormItem",{attrs:{label:"邮箱："}},[t("Input",{model:{value:e.formData.email,callback:function(a){e.$set(e.formData,"email",a)},expression:"formData.email"}})],1),t("FormItem",{attrs:{label:"登录密码：",prop:"password"}},[t("Input",{attrs:{type:"password"},model:{value:e.formData.password,callback:function(a){e.$set(e.formData,"password",a)},expression:"formData.password"}})],1),t("FormItem",{attrs:{label:"登录密码确认：",prop:"password_confirmation"}},[t("Input",{attrs:{type:"password"},model:{value:e.formData.password_confirmation,callback:function(a){e.$set(e.formData,"password_confirmation",a)},expression:"formData.password_confirmation"}})],1),t("FormItem",{attrs:{label:"可登录后台："}},[t("RadioGroup",{model:{value:e.formData.is_admin,callback:function(a){e.$set(e.formData,"is_admin",a)},expression:"formData.is_admin"}},[t("Radio",{attrs:{label:"F"}},[e._v("否")]),t("Radio",{attrs:{label:"T"}},[e._v("是")])],1)],1),t("FormItem",{attrs:{label:"头像："}},[t("upload",{attrs:{"upload-config":e.imguploadConfig},on:{"on-upload-change":e.uploadChange},model:{value:e.formData.head_image,callback:function(a){e.$set(e.formData,"head_image",a)},expression:"formData.head_image"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),t("Button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.addUserExcute}},[e._v("保存 ")])],1)],1)],1)}),s=[],l=t("c24f"),r=t("c13c"),d={components:{Upload:r["a"]},data:function(){var e=this,a=function(a,t,o){""===t?o(new Error("请输入登录密码")):(""!==e.formData.password&&e.$refs.formData.validateField("password_confirmation"),o())},t=function(a,t,o){""===t?o(new Error("请输入确认密码")):t!==e.formData.password?o(new Error("两次密码不一致 ")):o()};return{modalShow:!0,saveLoading:!1,formData:{name:"",email:"",is_admin:"F",password:"",password_confirmation:"",head_image:{attachment_id:0,url:""}},uploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png"],max_size:500,uploadUrl:window.uploadUrl.uploadAvatar},imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:500,upload_url:window.uploadUrl.uploadAvatar,file_name:"file",multiple:!1,file_num:1,default_list:[]},rules:{name:[{required:!0,message:"请填写昵称",trigger:"blur"},{type:"string",min:2,message:"昵称至少要 2 个字符",trigger:"blur"}],email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],password:[{validator:a,trigger:"blur"}],password_confirmation:[{validator:t,trigger:"blur"}]}}},methods:{addUserExcute:function(){var e=this;e.$refs.formData.validate(function(a){a?(e.saveLoading=!0,Object(l["a"])(e.formData).then(function(a){e.saveLoading=!1,e.modalShow=!1,e.$emit("on-add-modal-success"),e.$emit("on-add-modal-hide"),e.$Notice.success({title:a.message})},function(a){e.saveLoading=!1})):e.saveLoading=!1})},cancel:function(){this.modalShow=!1,this.$emit("on-add-modal-hide")},editContentChange:function(e,a){},uploadChange:function(e,a){}}},c=d,u=t("66b7"),m=Object(u["a"])(c,n,s,!1,null,null,null);m.options.__file="add-user.vue";var f=m.exports,p=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"600"},model:{value:e.modalShow,callback:function(a){e.modalShow=a},expression:"modalShow"}},[t("p",{attrs:{slot:"header"},slot:"header"},[e._v("修改用户信息")]),t("Form",{ref:"formData",attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":100}},[t("FormItem",{attrs:{label:"昵称：",prop:"name"}},[t("Input",{model:{value:e.formData.name,callback:function(a){e.$set(e.formData,"name",a)},expression:"formData.name"}})],1),t("FormItem",{attrs:{label:"邮箱："}},[t("Input",{model:{value:e.formData.email,callback:function(a){e.$set(e.formData,"email",a)},expression:"formData.email"}})],1),t("FormItem",{attrs:{label:"登录密码："}},[t("Input",{attrs:{type:"password"},model:{value:e.formData.password,callback:function(a){e.$set(e.formData,"password",a)},expression:"formData.password"}})],1),t("FormItem",{attrs:{label:"登录密码确认："}},[t("Input",{attrs:{type:"password"},model:{value:e.formData.password_confirmation,callback:function(a){e.$set(e.formData,"password_confirmation",a)},expression:"formData.password_confirmation"}})],1),t("FormItem",{attrs:{label:"可登录后台："}},[t("RadioGroup",{model:{value:e.formData.is_admin,callback:function(a){e.$set(e.formData,"is_admin",a)},expression:"formData.is_admin"}},[t("Radio",{attrs:{label:"F"}},[e._v("否")]),t("Radio",{attrs:{label:"T"}},[e._v("是")])],1)],1),t("FormItem",{attrs:{label:"头像："}},[e.formdataFinished?t("upload",{attrs:{"is-delete":!1,"upload-config":e.imguploadConfig},on:{"on-upload-change":e.uploadChange},model:{value:e.formData.head_image,callback:function(a){e.$set(e.formData,"head_image",a)},expression:"formData.head_image"}}):e._e()],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:e.cancel}},[e._v("取消")]),t("Button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.editUserExcute}},[e._v("保存\n                ")])],1),!0===e.spinLoading?t("div",{staticClass:"demo-spin-container"},[t("Spin",{attrs:{fix:""}},[t("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),t("div",[e._v("加载中...")])],1)],1):e._e()],1)],1)},h=[],g=(t("c5f6"),{components:{Upload:r["a"]},props:{modalId:{type:Number,default:0}},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{name:"",email:"",is_admin:"F",password:"",password_confirmation:"",head_image:{attachment_id:0,url:""}},formdataFinished:!1,imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:500,upload_url:window.uploadUrl.uploadAvatar,file_name:"file",multiple:!1,file_num:1,default_list:[]},rules:{name:[{required:!0,message:"请填写昵称",trigger:"blur"},{type:"string",min:2,message:"昵称至少要 2 个字符",trigger:"blur"}],email:[{required:!0,message:"请填写邮箱",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}]}}},mounted:function(){this.modalId>0&&this.getUserInfoByIdExcute()},methods:{getUserInfoByIdExcute:function(){var e=this;Object(l["g"])(e.modalId).then(function(a){var t=a.data;e.formData={id:t.id,name:t.name,email:t.email,is_admin:t.is_admin,password:"",password_confirmation:"",head_image:{attachment_id:t.head_image.attachment_id,url:t.head_image.url}},e.imguploadConfig.default_list=[e.formData.head_image],e.formdataFinished=!0,e.spinLoading=!1})},editUserExcute:function(){var e=this,a=this;a.$refs.formData.validate(function(t){t?(a.saveLoading=!0,Object(l["c"])(a.modalId,a.formData).then(function(t){a.saveLoading=!1,a.modalShow=!1,a.$emit("on-edit-modal-success"),e.$emit("on-edit-modal-hide"),a.$Notice.success({title:t.message})},function(e){a.saveLoading=!1})):a.saveLoading=!1})},cancel:function(){this.modalShow=!1,this.$emit("on-edit-modal-hide")},editContentChange:function(e,a){},uploadChange:function(e,a){}}}),_=g,v=Object(u["a"])(_,p,h,!1,null,null,null);v.options.__file="edit-user.vue";var b=v.exports,w=t("2934"),x={components:{AddComponent:f,EditComponent:b},data:function(){var e=this;return{searchForm:{order_by:"created_at,desc"},tableLoading:!1,tableStatus:{enable:[],is_admin:[]},feeds:{data:[],total:0,current_page:1,per_page:10},modalHeadImage:{show:!1,url:null},roleModal:{id:0,allRoles:[],hasRoles:[],show:!1,saveLoading:!1,listStyle:{width:"250px",height:"300px"}},addModal:{show:!1},editModal:{show:!1,id:0},columns:[{title:"ID",key:"id",sortable:"customer",minWidth:100},{title:"昵称",key:"name",minWidth:100},{title:"头像",key:"",minWidth:150,render:function(a,t){var o=e;return a("div",[a("img",{attrs:{src:t.row.head_image.url,"data-fancybox":"12312"},class:"head_image",style:{width:"40px",height:"40px"},on:{click:function(e){o.modalHeadImage.show=!0,o.modalHeadImage.url=t.row.head_image.url}}})])}},{title:"邮箱",key:"email",minWidth:150},{title:"后台权限",minWidth:150,render:function(e,a){var t=a.row,o="T"===t.is_admin?"green":"red",i="T"===t.is_admin?"可登录":"不可登录";return e("div",[e("Tag",{props:{color:o}},i)])}},{title:"启用状态",key:"enable",minWidth:150,render:function(a,t){return a("i-switch",{props:{slot:"open",type:"primary",value:"T"===t.row.enable},on:{"on-change":function(a){e.switchEnableExcute(t.index)}}})}},{title:"创建时间",key:"created_at",minWidth:150},{title:"最近登录时间",key:"last_login_at",sortable:"customer",minWidth:150},{title:"操作",key:"",minWidth:200,render:function(a,t){var o=e;return a("div",[a("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.editModal.show=!0,e.editModal.id=t.row.id}}},"Edit"),a("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){o.getUserRolesExcute(t.row.id),o.roleModal.show=!0,o.roleModal.id=t.row.id}}},"角色"),a("Poptip",{props:{confirm:!0,title:"您确定要删除「"+t.row.name+"」？",transfer:!0},on:{"on-ok":function(){o.deleteUserExcute(t.row.id,t.index)}}},[a("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},created:function(){var e=this;e.getTableStatusExcute("users"),e.getAllRoleExcute(),e.getTableDataExcute(e.feeds.current_page)},methods:{handleOnPageChange:function(e){this.getTableDataExcute(e)},onPageSizeChange:function(e){this.feeds.per_page=e,this.getTableDataExcute(this.feeds.current_page)},getTableStatusExcute:function(e){var a=this;Object(w["b"])(e).then(function(e){a.tableStatus.enable=e.data.enable,a.tableStatus.is_admin=e.data.is_admin})},getTableDataExcute:function(e){var a=this;a.tableLoading=!0,a.feeds.current_page=e,Object(l["e"])(e,a.feeds.per_page,a.searchForm).then(function(e){a.feeds.data=e.data,a.feeds.total=e.meta.total,a.tableLoading=!1},function(e){a.tableLoading=!1})},onSortChange:function(e){var a=e.column.key+","+e.order;this.searchForm.order_by=a,this.getTableDataExcute(this.feeds.current_page)},switchEnableExcute:function(e){var a=this,t="T";"T"===a.feeds.data[e].enable&&(t="F"),Object(w["c"])(a.feeds.data[e].id,"users",t).then(function(o){a.feeds.data[e].enable=t,a.$Notice.success({title:o.message})})},getAllRoleExcute:function(){var e=this;Object(l["d"])().then(function(a){e.roleModal.allRoles=a.data})},handleTransferChange:function(e){this.roleModal.hasRoles=e},getUserRolesExcute:function(e){var a=this;Object(l["h"])(e).then(function(e){a.roleModal.hasRoles=e.data})},renderFormat:function(e){return e.label+"「"+e.description+"」"},giveUserRoleExcute:function(){var e=this;Object(l["i"])(e.roleModal.id,e.roleModal.hasRoles).then(function(a){e.$Notice.success({title:"操作成功",desc:a.message}),e.roleModal.show=!1})},cancelRoleModal:function(){var e=this;e.roleModal.show=!1,e.roleModal.saveLoading=!1},deleteUserExcute:function(e,a){var t=this;Object(l["b"])(e).then(function(e){t.feeds.data.splice(a,1),t.$Notice.success({title:e.message})})},addBtn:function(){this.addModal.show=!0},addModalHide:function(){this.addModal.show=!1},editModalHide:function(){this.editModal.show=!1}}},y=x,D=Object(u["a"])(y,o,i,!1,null,null,null);D.options.__file="list.vue";a["default"]=D.exports},c13c:function(e,a,t){"use strict";var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[e._l(e.uploadList,function(a){return t("div",{staticClass:"demo-upload-list"},["finished"===a.status?[t("img",{attrs:{src:a.url}}),t("div",{staticClass:"demo-upload-list-cover"},[t("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(t){e.handleRemove(a)}}})],1)]:[a.showProgress?t("Progress",{attrs:{percent:a.percentage,"hide-info":""}}):e._e()]],2)}),t("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.uploadConfig.default_list,"on-success":e.handleSuccess,headers:e.uploadConfig.headers,format:e.uploadConfig.format,"max-size":e.uploadConfig.max_size,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:e.uploadConfig.multiple,name:e.uploadConfig.file_name,type:"drag",action:e.uploadConfig.upload_url}},[t("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[t("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),e.formatFileList.length>0?t("Collapse",[t("Panel",{attrs:{name:"1"}},[e._v("\n      预览\n      "),t("p",{attrs:{slot:"content"},slot:"content"},e._l(e.formatFileList,function(e,a){return t("img",{staticStyle:{width:"100%"},attrs:{src:e.url,alt:e.name}})}))])],1):e._e()],2)},i=[],n=(t("7f7f"),t("ac6a"),t("2934")),s={props:{isDelete:{type:Boolean,default:!0},uploadConfig:{type:Object,default:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:800,upload_url:window.uploadUrl.uploadTmp,file_name:"file",multiple:!1,file_num:0,default_list:[{name:"",attachment_id:0,url:""},{name:"",attachment_id:0,url:""}]}}},data:function(){return{imgName:"",visible:!1,uploadList:[],formatFileList:[]}},methods:{handleRemove:function(e){var a=this,t=this.$refs.upload.fileList;e.attachment_id>0&&!0===this.isDelete&&Object(n["a"])(e.attachment_id).then(function(e){a.$Notice.success({title:"操作成功",desc:"文件删除成功"})}),this.$refs.upload.fileList.splice(t.indexOf(e),1);var o=this.fomatFile();this.$emit("input",o),this.$emit("on-upload-change",this.uploadList,o)},handleSuccess:function(e,a){a.url=e.data.url,a.name=e.data.original_name,a.attachment_id=e.data.attachment_id;var t=this.fomatFile();this.$emit("input",t),this.$emit("on-upload-change",this.uploadList,t)},fomatFile:function(){var e=[];return this.uploadList.forEach(function(a,t,o){e.push({attachment_id:a.attachment_id,url:a.url})}),this.formatFileList=e,1===this.uploadConfig.file_num&&(e=e[0]),e},handleFormatError:function(e){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+e.name+" 格式不正确。"})},handleMaxSize:function(e){this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+e.name+" 太大，不能超过 "+this.uploadConfig.max_size+"kb"})},handleBeforeUpload:function(){var e=this.uploadList.length<this.uploadConfig.file_num;return e||this.$Notice.warning({title:"数量限制",desc:"最多只能上传"+this.uploadConfig.file_num+"个文件"}),e}},mounted:function(){this.uploadList=this.$refs.upload.fileList;var e=this.fomatFile();"undefined"!=e&&(this.$emit("input",e),this.$emit("on-upload-change",this.uploadList,e))}},l=s,r=(t("6a8f"),t("66b7")),d=Object(r["a"])(l,o,i,!1,null,null,null);d.options.__file="upload.vue";a["a"]=d.exports}}]);
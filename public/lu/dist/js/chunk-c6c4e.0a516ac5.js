(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c6c4e"],{2934:function(t,e,a){"use strict";a.d(e,"b",function(){return o}),a.d(e,"c",function(){return n}),a.d(e,"a",function(){return i});var s=a("66df"),o=function(t){return s["a"].request({url:"/api/common_get_table_status/"+t,method:"get"})},n=function(t,e,a){return s["a"].request({url:"/api/common_switch_enable",data:{id:t,table:e,value:a},method:"post"})},i=function(t){return s["a"].request({url:"/api/admin/attachments/"+t+"/force_destroy",method:"delete"})}},fa32:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{attrs:{gutter:24}},[a("Col",{attrs:{xs:4,lg:3}},[a("Select",{attrs:{placeholder:"消息类型"},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},[a("Option",{key:"",attrs:{value:""}},[t._v("全部")]),t._l(t.tableStatus.type,function(e,s){return a("Option",{key:s,attrs:{value:s}},[t._v(t._s(e))])})],2)],1),a("Col",{attrs:{xs:4,lg:3}},[a("Select",{attrs:{placeholder:"状态"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[a("Option",{key:"",attrs:{value:""}},[t._v("全部")]),t._l(t.tableStatus.status,function(e,s){return a("Option",{key:s,attrs:{value:s}},[t._v(t._s(e))])})],2)],1),a("Col",{attrs:{xs:4,lg:4}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){t.getTableDataExcute(t.feeds.current_page)}}},[t._v("Search")])],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:4,lg:2}},[a("Poptip",{attrs:{confirm:"",placement:"bottom",title:"确认要操作?","ok-text":"确认","cancel-text":"点错了"},on:{"on-ok":function(e){t.readMessagesExcute(t.selectIds,!1)}}},[a("Button",[t._v("读取选中消息")])],1)],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:3,lg:2}},[a("Poptip",{attrs:{confirm:"",placement:"bottom",title:"确认要操作?","ok-text":"确认","cancel-text":"点错了"},on:{"on-ok":function(e){t.readMessagesExcute("",!0)}}},[a("Button",{attrs:{type:"warning"}},[t._v("一键已读")])],1)],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:3,lg:2}},[a("Poptip",{attrs:{confirm:"",placement:"bottom",title:"确认要操作?","ok-text":"确认","cancel-text":"点错了"},on:{"on-ok":function(e){t.deleteManyAdminMessageExcute(t.selectIds)}}},[a("Button",{attrs:{type:"error"}},[t._v("删除选中消息")])],1)],1)],1),a("br"),a("Row",[t.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e(),a("Table",{attrs:{border:"",columns:t.columns,data:t.feeds.data},on:{"on-sort-change":t.onSortChange,"on-selection-change":t.onSelectionChange}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:t.feeds.total,current:t.feeds.current_page,"page-size":t.feeds.per_page,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-change":t.handleOnPageChange,"on-page-size-change":t.onPageSizeChange}})],1)])],1),t.showInfoModal.show?a("show-info",{attrs:{info:t.showInfoModal.info},on:{"show-modal-close":t.showModalClose}}):t._e()],1)},o=[],n=a("2934"),i=a("66df"),r=function(t,e,a){return i["a"].request({url:"/api/admin/admin_messages",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},l=function(t){return i["a"].request({url:"/api/admin/admin_messages/"+t+"/many",method:"delete"})},c=function(t,e){return i["a"].request({url:"/api/admin/admin_messages/read_messages",data:{is_read_all:t,message_ids:e},method:"post"})},d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Drawer",{attrs:{closable:!1,title:"消息详情",width:t.platformIsPc?30:80},on:{"on-close":t.closed},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("p",{staticClass:"drawer-title"},[t._v("基本资料：")]),a("div",{staticClass:"drawer-profile"},[a("Row",[a("Col",{attrs:{span:"12"}},[t._v(" 消息标题： "+t._s(t.info.title)+" ")]),t.info.user?a("Col",{attrs:{span:"12"}},[t._v(" 发送人："+t._s(t.info.user.name)+" ("+t._s(t.info.user.phone)+") ")]):t._e()],1),a("hr",{staticClass:"hr-line-0"}),a("p",{staticClass:"drawer-title"},[t._v("消息内容：")]),a("div",{domProps:{innerHTML:t._s(t.info.content)}})],1)])],1)},u=[],p=(a("cadf"),a("551c"),a("097d"),{props:{info:{type:Object,default:""}},data:function(){return{show:!0,agreement:""}},computed:{platformIsPc:function(){return"pc"==this.globalPlatformType()}},methods:{closed:function(){this.show=!1,this.$emit("show-modal-close")}}}),f=p,h=a("66b7"),m=Object(h["a"])(f,d,u,!1,null,null,null);m.options.__file="show-info.vue";var g=m.exports,_={components:{ShowInfo:g},data:function(){var t=this;return{selectIds:"",searchForm:{order_by:"id,desc"},showInfoModal:{show:!1,info:""},tableLoading:!1,tableStatus:{status:"",type:""},feeds:{data:[],total:0,current_page:1,per_page:10},addModal:{show:!1},editModal:{show:!1,id:0},columns:[{type:"selection",minWidth:60,align:"center"},{title:"ID",key:"id",sortable:"customer",minWidth:50},{title:"标题",key:"title",minWidth:100},{title:"类型",minWidth:100,render:function(e,a){return e("div",t.tableStatus.type[a.row.type])}},{title:"状态",minWidth:150,render:function(t,e){var a=e.row,s="R"===a.status?"green":"red",o="R"===a.status?"已读":"未读";return t("div",[t("Tag",{props:{color:s}},o)])}},{title:"创建时间",key:"created_at",sortable:"customer",minWidth:150},{title:"操作",minWidth:150,render:function(e,a){var s=t,o=e("Poptip",{props:{confirm:!0,title:"您确定要操作？",transfer:!0},on:{"on-ok":function(){s.readMessagesExcute(a.row.id,!1)}}},[e("Button",{style:{margin:"0 5px"},props:{type:"info",size:"small",placement:"top"}},"标为已读")]);return"R"===a.row.status&&(o=""),e("div",[e("Button",{style:{margin:"0 5px"},props:{type:"success",size:"small"},on:{click:function(){t.showInfoModal.show=!0,t.showInfoModal.info=a.row}}},"详细"),o,e("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.title+"」？",transfer:!0},on:{"on-ok":function(){s.deleteTagExcute(a.row.id,a.index)}}},[e("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")])])}}]}},mounted:function(){var t=this;t.getTableStatusExcute("admin_messages"),t.getTableDataExcute(t.feeds.current_page)},methods:{getTableStatusExcute:function(t){var e=this;Object(n["b"])(t).then(function(t){e.tableStatus.status=t.data.status,e.tableStatus.type=t.data.type})},handleOnPageChange:function(t){this.getTableDataExcute(t)},onPageSizeChange:function(t){this.feeds.per_page=t,this.getTableDataExcute(this.feeds.current_page)},getTableDataExcute:function(t){var e=this;e.tableLoading=!0,e.feeds.current_page=t,r(t,e.feeds.per_page,e.searchForm).then(function(t){e.feeds.data=t.data,e.feeds.total=t.meta.total,e.tableLoading=!1},function(t){e.tableLoading=!1})},onSortChange:function(t){var e=t.column.key+","+t.order;this.searchForm.order_by=e,this.getTableDataExcute(this.feeds.current_page)},readMessagesExcute:function(t,e){if(!1===e&&!t)return this.$Notice.error({title:"出错了",desc:"请先选择要操作的项"}),!1;var a=this;c(e,t).then(function(t){a.getTableDataExcute(a.feeds.current_page)})},deleteManyAdminMessageExcute:function(t){if(!t)return this.$Notice.error({title:"出错了",desc:"请先选择要操作的项"}),!1;var e=this;l(t).then(function(t){e.getTableDataExcute(e.feeds.current_page)})},onSelectionChange:function(t){for(var e in this.selectIds="",t)this.selectIds+=","+t[e].id},deleteTagExcute:function(t,e){var a=this;deleteTag(t).then(function(t){a.feeds.data.splice(e,1),a.$Notice.success({title:t.message})})},addBtn:function(){this.addModal.show=!0},addModalHide:function(){this.addModal.show=!1},editModalHide:function(){this.editModal.show=!1},showModalClose:function(){this.showInfoModal.show=!1}}},w=_,v=Object(h["a"])(w,s,o,!1,null,null,null);v.options.__file="list.vue";e["default"]=v.exports}}]);